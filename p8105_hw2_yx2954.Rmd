---
title: "p8105_hw2_yx2954"
author: "Yiran Xu"
date: "2024-09-27"
output: github_document
---

# Question 1

```{r, echo = FALSE, message = FALSE}
library(dplyr)
library(readr)
library(tidyr)
```

```{r}
subway_df = read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", na = c("NA", "", ".")) |>
  select(Line, Station_Name = `Station Name`, Station_Latitude = `Station Latitude`, Station_Longitude = `Station Longitude`, Route1:Route11, Entry, Vending, Entrance_Type = `Entrance Type`, ADA) |>
  mutate(Entry = ifelse(Entry == "YES", TRUE, FALSE))|>
  janitor::clean_names()

head(subway_df)
```

## Description

The original dataset contains different types of **variables**, **including character**, **logical variable** and double-precision floating point (**numeric variable**); As for the information, it contains **detailed information about subway stations, including station name, exact locations, the routes they serve, entrance/exit information, ADA compliance, vending availability, staffing information, entrance location, corner location and whether the station allows free crossovers**.
The original dataset has gone through a series of data cleaning process, including **imputing missing data, data pruning, converting the character variable of ADA to logical variable, and normalizing the header into a more cleaning way**. The cleaned data has a dimension of **1,868 Ã— 32**. The data is **tidy**, as now each value in the entry is finely positioned without mixing.

## Answer the following questions using these data:

```{r}
num_station = 
  subway_df |>
  distinct(line, station_name) |>
  nrow()

num_ada =
  subway_df |>
  filter(ada == TRUE) |>
  distinct(line, station_name) |>
  nrow()

prop_vending = subway_df |>
  filter(vending == "NO") |>
  summarise(proportion = mean(entry == TRUE)) |>
  pull(proportion)
```

There are **`r num_station`** stations, **`r num_ada`** of them are ADA compliant, **`r prop_vending`** of station entrances / exits without vending allow entrance

## Reformat data

```{r}
subway_tidy_df = 
  subway_df |>
  mutate(across(route8:route11, as.character)) |>
  pivot_longer(
    cols = starts_with("route"),
    names_to = "route_number",  
    values_to = "route_name",   
    values_drop_na = TRUE      
  )
```

Calculate number of A train station with ADA

```{r}
num_a_ada = 
  subway_tidy_df |>
  filter(route_name == "A") |>
  filter(ada == TRUE) |>
  nrow()
```

Of the stations that serve the A train, **`r num_a_ada`** are ADA compliant

# Question 2
